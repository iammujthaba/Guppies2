{% extends 'admin_app/base_admin.html' %}

{% block content %}
<h1>Order Detail - {{ order.customer.name }}</h1>
<p>Customer: {{ order.customer.name }}</p>
<p>email: {{ order.customer.email }}</p>
<p>Status: {{ order.status }}</p>
<p>Total: {{ order.get_cart_total }}</p>
<p>Date Ordered: {{ order.date_ordered }}</p>

{% if order.status == 'Shipped' %}
<p>Shipped date: {{ order.shipped_time }}</p>
{% endif %}
{% if order.status == 'Delivered' %}
<p>Shipped date: {{ order.shipped_time }}</p>
<p>delivered date: {{ order.delivered_time }}</p>
{% endif %}


<h2>Shipping Address</h2>
{% if shipping_address %}
    <p>Number: {{ shipping_address.number }}</p>
    <p>Address: {{ shipping_address.address }}</p>
    <p>City: {{ shipping_address.city }}</p>
    <p>State: {{ shipping_address.state }}</p>
    <p>Zipcode: {{ shipping_address.zipcode }}</p>
{% else %}
    <p>No shipping address available.</p>
{% endif %}

<h2>Items</h2>
<table>
    <thead>
        <tr>
            <th>Product</th>
            <th>Quantity</th>
            <th>Total</th>
        </tr>
    </thead>
    <tbody>
        {% for item in order.orderitem_set.all %}
        <tr>
            <td>{{ item.product.name }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ item.get_total }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% if order.status != 'Delivered' %}
<h2>Update Order Status</h2>
<form method="post">
    {% csrf_token %}
    <label for="status">Status:</label>
    <select id="status" name="status">
        {% for choice in order.STATUS_CHOICES %}
        <option value="{{ choice.0 }}" {% if order.status == choice.0 %}selected{% endif %}>{{ choice.1 }}</option>
        {% endfor %}
    </select>
    <button type="submit">Update</button>
</form>
{% else %}
<h2>Order Compleated</h2>
{% endif %}

{% endblock %}
